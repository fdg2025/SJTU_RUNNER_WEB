# 自动登录获取Cookie功能指南

## 🎯 功能概述

新增的自动登录功能允许用户直接输入SJTU账号密码，系统将自动登录并获取Cookie，无需手动复制粘贴。

## 🚀 使用方法

### 步骤1：选择自动登录
1. 在Cookie输入框下方，点击 **"自动登录"** 按钮
2. 系统会展开自动登录表单

### 步骤2：输入账号信息
1. **用户名**：输入你的SJTU学号或JAccount用户名
2. **密码**：输入对应的密码
3. 点击 **"自动获取Cookie"** 按钮

### 步骤3：等待自动登录
- 系统会显示"正在登录..."状态
- 登录成功后，Cookie会自动填充到输入框
- 密码字段会自动清空（安全考虑）

## 🔒 安全特性

### 密码安全
- ✅ **不存储密码**：密码仅用于登录，不会被保存
- ✅ **自动清空**：登录成功后密码字段立即清空
- ✅ **内存清理**：登录完成后密码从内存中清除
- ✅ **HTTPS传输**：所有数据传输都经过加密

### 隐私保护
- ✅ **本地处理**：登录过程在服务器端完成，前端不接触密码
- ✅ **会话隔离**：每次登录都是独立的会话
- ✅ **无日志记录**：密码不会被记录到任何日志文件

## ⚠️ 使用建议

### 推荐场景
- ✅ **私人设备**：在自己的电脑或手机上使用
- ✅ **可信网络**：在安全的网络环境下使用
- ✅ **临时使用**：偶尔使用自动登录功能

### 不推荐场景
- ❌ **公共设备**：在网吧、图书馆等公共电脑上使用
- ❌ **不信任网络**：在公共WiFi或不安全的网络环境下
- ❌ **长期存储**：不建议长期依赖自动登录功能

## 🔄 两种获取方式对比

| 方式 | 自动登录 | 手动复制 |
|------|----------|----------|
| **便利性** | ⭐⭐⭐⭐⭐ 一键获取 | ⭐⭐⭐ 需要手动操作 |
| **安全性** | ⭐⭐⭐⭐ 密码不存储 | ⭐⭐⭐⭐⭐ 完全本地操作 |
| **技术要求** | ⭐⭐⭐⭐⭐ 无需技术知识 | ⭐⭐⭐ 需要会使用F12 |
| **适用场景** | 私人设备 | 所有场景 |
| **推荐指数** | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ |

## 🛠️ 技术实现

### 后端流程
1. **获取登录页面**：提取CSRF令牌等必要信息
2. **模拟登录**：使用用户名密码进行POST请求
3. **处理重定向**：跟随登录成功后的重定向
4. **提取Cookie**：从响应头中提取keepalive和JSESSIONID
5. **返回结果**：将Cookie返回给前端

### 前端集成
- **AutoLoginForm组件**：处理用户输入和状态管理
- **ConfigForm集成**：与现有Cookie输入框无缝集成
- **状态同步**：自动验证和填充Cookie

## 🐛 故障排除

### 常见问题

#### 1. 登录失败
**症状**：显示"登录失败，请检查用户名和密码"
**解决方案**：
- 确认用户名和密码正确
- 检查SJTU账号是否被锁定
- 尝试手动登录SJTU系统确认账号状态

#### 2. Cookie获取失败
**症状**：登录成功但Cookie为空
**解决方案**：
- 稍后重试，可能是网络延迟
- 检查SJTU系统是否正常
- 使用手动复制方式作为备选

#### 3. 网络超时
**症状**：显示"请求超时"错误
**解决方案**：
- 检查网络连接
- 稍后重试
- 使用手动复制方式

### 错误代码说明

| 错误代码 | 含义 | 解决方案 |
|----------|------|----------|
| 401 | 认证失败 | 检查用户名密码 |
| 403 | 访问被拒绝 | 检查账号权限 |
| 500 | 服务器错误 | 稍后重试或联系管理员 |
| 超时 | 网络问题 | 检查网络连接 |

## 📝 使用示例

### 成功流程
```
1. 点击"自动登录"按钮
2. 输入用户名：2020123456
3. 输入密码：********
4. 点击"自动获取Cookie"
5. 显示"正在登录..."
6. 显示"自动登录成功！Cookie已自动填充"
7. Cookie输入框显示：keepalive=xxx; JSESSIONID=xxx
8. 密码字段自动清空
```

### 失败处理
```
1. 输入错误密码
2. 点击"自动获取Cookie"
3. 显示"登录失败，请检查用户名和密码"
4. 重新输入正确密码
5. 再次尝试登录
```

## 🔧 开发者信息

### API端点
- **POST** `/api/auto-login`
- **认证**：需要前端登录令牌
- **参数**：`{ username: string, password: string }`
- **返回**：`{ success: boolean, cookie?: string, error?: string }`

### 组件结构
```
ConfigForm
├── Cookie输入框
├── 获取方式按钮
│   ├── 手动获取 (CookieHelper)
│   └── 自动登录 (AutoLoginForm)
└── 验证状态显示
```

## 📞 支持与反馈

如果遇到问题或需要帮助：
1. 查看故障排除部分
2. 尝试手动复制Cookie方式
3. 联系技术支持

---

**注意**：自动登录功能是为了提高用户体验而设计的便利功能。如果你对安全性有更高要求，建议使用手动复制Cookie的方式。

